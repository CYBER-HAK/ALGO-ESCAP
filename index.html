<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ALGO ESCAPE</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(180deg, #0c0c0c, #171717);
    color: white;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  h1 {
    margin-top: 30px;
    font-size: 2.8em;
    text-shadow: 0 0 15px #00ffaa;
  }

  #story {
    margin-top: 20px;
    width: 85%;
    text-align: center;
    padding: 15px;
    font-size: 1.2em;
    background: #141414;
    border-radius: 12px;
  }

  #stats {
    margin-top: 15px;
    width: 85%;
    padding: 10px;
    background: #222;
    border-radius: 10px;
    font-size: 1.2em;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  #bubbleBar {
    flex-grow: 1;
    height: 20px;
    background: #444;
    border-radius: 10px;
    overflow: hidden;
  }

  #bubbleFill {
    height: 100%;
    width: 80%;
    background: #00ffaa;
    transition: width 0.3s;
  }

  #feed {
    width: 380px;
    margin-top: 20px;
  }

  .post {
    background: #252525;
    padding: 15px;
    margin: 15px 0;
    border-radius: 12px;
    cursor: pointer;
    border-left: 5px solid #00ffaa33;
    transition: 0.25s;
  }

  .post:hover {
    transform: scale(1.05);
    background: #303030;
  }

  #winScreen, #gameOver {
    margin-top: 40px;
    font-size: 2em;
    display: none;
    text-align: center;
  }

  .fade {
    animation: fade 0.35s ease;
  }

  @keyframes fade {
    from {opacity: 0; transform: translateY(10px);}
    to   {opacity: 1; transform: translateY(0);}
  }
</style>
</head>
<body>

<h1>ALGO ESCAPE</h1>

<div id="story"></div>

<div id="stats">
  Filterblase: <span id="bubbleValue">80</span>%
  <div id="bubbleBar"><div id="bubbleFill"></div></div>
</div>

<div id="feed"></div>

<div id="winScreen">ðŸŽ‰ Du hast den Algorithmus besiegt!</div>
<div id="gameOver">ðŸ’€ Die Filterblase ist explodiert!</div>

<script>
let level = 1;
let bubble = 80;

const bubbleValue = document.getElementById("bubbleValue");
const bubbleFill = document.getElementById("bubbleFill");
const storyBox = document.getElementById("story");
const feed = document.getElementById("feed");
const win = document.getElementById("winScreen");
const gameOver = document.getElementById("gameOver");

let availablePosts = [];

// ---------------- LEVELS ----------------

const levels = {
  1: {
    story: "Level 1: Dein Feed wirkt merkwÃ¼rdig einseitigâ€¦ erkennst du die Muster?",
    posts: [
      {text: "Ein harmloses Meme", effect: -5},
      {text: "Ein sÃ¼ÃŸes Tiervideo", effect: -5},
      {text: "Eine sinnlose Werbung", effect: +5},
      {text: "Ein kurzer Lernclip", effect: -10},
      {text: "Ein DIY-Video", effect: -5},
      {text: "Ein neutraler News-Beitrag", effect: -5},
      {text: "Ein Clip ohne Aussage", effect: +5},
      {text: "Ein interessantes Fakt-Video", effect: -10},
      {text: "Ein weiteres Meme", effect: -5},
      {text: "Ein Clip Ã¼ber ein uninteressantes Thema", effect: +5},
      {text: "Ein entspannter Naturclip", effect: -5},
      {text: "Eine Produktwerbung", effect: +5},
      {text: "Ein kurzer Politik-Ausschnitt", effect: -5},
      {text: "Ein harmloses Reaction-Video", effect: -5},
      {text: "Ein kurzer Info-Snippet", effect: -10},
      {text: "Ein Tierbaby-Video", effect: -5},
      {text: "Ein weiterer Lernbeitrag", effect: -5},
      {text: "Ein Video: '10 Dinge, die du nicht wusstest!'", effect: -10},
      {text: "Ein Video: 'Die 5 besten Lifehacks!'", effect: -5},
      {text: "Ein Clip ohne Kontext", effect: +5}
    ],
    minigame: function() {
      console.log("Minigame Level 1 gestartet");
    }
  },

  2: {
    story: "Level 2: Der Algorithmus setzt auf starke Emotionenâ€¦ bleib wachsam!",
    posts: [
      {text: "EmpÃ¶rungspost: 'Wie kann DAS erlaubt sein?!'", effect: +15},
      {text: "Clickbait: 'Du wirst SCHOCKIERT sein!'", effect: +10},
      {text: "Drama-Video: 'Ich kann nicht mehrâ€¦'", effect: +10},
      {text: "Kommentarstreit unter Fremden", effect: +10},
      {text: "Video mit Ã¼bertriebenen Behauptungen", effect: +10},
      {text: "Emotionaler Appell", effect: +10},
      {text: "Politischer Streitpost", effect: +15},
      {text: "Ein sachlicher Infoartikel", effect: -10},
      {text: "Ein Nachrichtenclip", effect: -10},
      {text: "Ein ruhiger Wissenschaftsbeitrag", effect: -15},
      {text: "Ein neutraler Gesundheitsbeitrag", effect: -10},
      {text: "Video: 'Er hat DAS wirklich getan??'", effect: +10},
      {text: "Skandalpost Ã¼ber Promis", effect: +15},
      {text: "Ein faktenbasierter Bericht", effect: -10},
      {text: "Ein ruhiger ErklÃ¤rbeitrag", effect: -10},
      {text: "Ein neutraler Podcast-Ausschnitt", effect: -10},
      {text: "Ein Info-Video Ã¼ber Geschichte", effect: -10},
      {text: "Ein Clip Ã¼ber Forschung", effect: -10},
      {text: "Ein Lernvideo", effect: -10},
      {text: "Eine positive Nachricht", effect: -5}
    ],
    minigame: function() {
      console.log("Minigame Level 2 gestartet");
    }
  },

  3: {
    story: "Finales Level: Nur ein Minigame kann dich befreien!",
    posts: [
      {text: "Politisches Drama", effect: +15},
      {text: "Fakten-Check Video", effect: -15},
      {text: "Tier-Video", effect: -5},
      {text: "Clickbait", effect: +10},
      {text: "Neutraler Info-Clip", effect: -10},
      {text: "Emotionaler Aufruf", effect: +15},
      {text: "Kurzer Lernbeitrag", effect: -10},
      {text: "Unterhaltsamer Clip", effect: -5},
      {text: "Skandalpost", effect: +15},
      {text: "Harmloses DIY-Video", effect: -5}
    ],
    minigame: function() {
      console.log("Minigame Level 3 gestartet");
    }
  }
};

// ---------------- START ----------------

function startLevel() {
  bubble = 80;
  updateBubble();
  storyBox.textContent = levels[level].story;

  availablePosts = [...levels[level].posts];
  feed.innerHTML = "";
  renderPosts();

  levels[level].minigame();
}

function renderPosts() {
  while (feed.children.length < 4) {

    // Falls leer â†’ auffÃ¼llen ohne Wiederholungen pro Durchlauf
    if (availablePosts.length === 0) {
      availablePosts = [...levels[level].posts];
    }

    let index = Math.floor(Math.random() * availablePosts.length);
    let post = availablePosts.splice(index, 1)[0];

    let div = document.createElement("div");
    div.className = "post fade";
    div.textContent = post.text;
    div.onclick = () => handlePostClick(div, post.effect);
    feed.appendChild(div);
  }
}

function handlePostClick(div, effect) {
  div.remove();

  bubble += effect;
  bubble = Math.max(0, Math.min(100, bubble));
  updateBubble();

  if (bubble === 0) {
    nextLevel();
    return;
  }

  if (bubble >= 100) {
    feed.style.display = "none";
    storyBox.style.display = "none";
    gameOver.style.display = "block";
    return;
  }

  renderPosts();
}

function updateBubble() {
  bubbleValue.textContent = bubble;
  bubbleFill.style.width = bubble + "%";
}

function nextLevel() {
  level++;
  if (level > 3) {
    feed.style.display = "none";
    storyBox.style.display = "none";
    win.style.display = "block";
    return;
  }
  startLevel();
}

startLevel();
</script>

</body>
</html>
