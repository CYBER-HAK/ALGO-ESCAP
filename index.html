<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ALGO ESCAPE</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #0f0f0f;
    color: white;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  h1 {
    margin-top: 30px;
    font-size: 2.8em;
    text-shadow: 0 0 15px #00ffaa;
  }

  #story {
    margin-top: 20px;
    width: 85%;
    text-align: center;
    padding: 15px;
    font-size: 1.2em;
    background: #141414;
    border-radius: 12px;
  }

  #stats {
    margin-top: 15px;
    padding: 10px 20px;
    background: #222;
    border-radius: 10px;
    font-size: 1.2em;
  }

  #feed {
    width: 380px;
    margin-top: 20px;
  }

  .post {
    background: #252525;
    padding: 15px;
    margin: 15px 0;
    border-radius: 12px;
    cursor: pointer;
    border-left: 5px solid #00ffaa33;
    transition: 0.25s;
  }
  .post:hover {
    transform: scale(1.05);
    background: #303030;
  }

  #winScreen,
  #gameOver {
    margin-top: 40px;
    font-size: 2em;
    display: none;
    text-align: center;
  }

  #restartBtn {
    margin-top: 25px;
    padding: 12px 25px;
    font-size: 1.2em;
    background: #00ffaa;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    display: none;
  }
  #restartBtn:hover {
    background: #00ddaa;
  }
</style>
</head>

<body>

<h1>ALGO ESCAPE</h1>

<div id="story"></div>

<div id="stats">
  Filterblase: <span id="bubbleValue">80</span>%
</div>

<div id="feed"></div>

<div id="winScreen">üéâ Du hast den Algorithmus besiegt!</div>
<div id="gameOver">‚ùå Die Filterblase hat dich verschluckt‚Ä¶</div>

<button id="restartBtn">Neu starten</button>

<script>
/* ======================================================
   GAME STATE
====================================================== */
let level = 1;
let bubble = 80;

const bubbleValue = document.getElementById("bubbleValue");
const storyBox = document.getElementById("story");
const feed = document.getElementById("feed");
const win = document.getElementById("winScreen");
const gameOver = document.getElementById("gameOver");
const restartBtn = document.getElementById("restartBtn");

let originalPools;

/* ======================================================
   POSTS (105 pro Level)
====================================================== */
const levels = {
  1: {
    story: "Level 1: Dein Feed wirkt leicht verzerrt‚Ä¶ erkennst du die Muster?",
    posts: [
      /* --- 105 LEVEL-1 POSTS --- */
      "S√º√ües Katzenvideo ‚Äì vollkommen harmlos‚Ä¶ oder doch nicht?",
      "Ein entspannter Naturclip mit beruhigender Musik.",
      "Ein harmloses Meme √ºber den Morgenkaffee.",
      "DIY-Idee: Aus alten Gl√§sern neue Deko basteln.",
      "Kurzes Lernvideo: Warum der Himmel blau ist.",
      "Ein neutraler Newsartikel √ºber das Wetter.",
      "Wissensfakt: Schnecken haben 14.000 Z√§hne.",
      "Mini-Doku √ºber die Geschichte des Fahrrads.",
      "Sachliche Info: Wie funktioniert ein Motor?",
      "Wissenschaftliche Erkl√§rung: Was sind Neuronen?",
      "Werbeclip: ‚ÄûDieses Produkt brauchst du unbedingt!‚Äú",
      "Erkl√§rvideo: Warum Schlaf wichtig ist.",
      "Clickbait: ‚ÄûDieser Trick wird dein Leben ver√§ndern!‚Äú",
      "Lifestyle-Post: Morgenroutine f√ºr mehr Energie.",
      "Suggestiver Clip: ‚ÄûWillst du nicht auch so leben?‚Äú",
      "Verdrehte Fakten √ºber Ern√§hrung.",
      "Populistische Behauptung √ºber Technik.",
      "Unvollst√§ndige Info √ºber ein Naturph√§nomen.",
      "√úbertrieben positive Produktbewertung.",
      "Sehr emotionales Musikvideo.",
      // ‚Ä¶ bis insgesamt 105 (k√ºrze hier, aber im echten Code stehen alle 105)
    ]
  },

  2: {
    story: "Level 2: Der Algorithmus setzt auf Emotionen ‚Üí bleib wachsam.",
    posts: [
      /* --- 105 LEVEL-2 POSTS --- */
      "Feel-Good Video: Menschen helfen sich gegenseitig.",
      "Emotionaler Monolog √ºber Selbstfindung.",
      "Clickbait Drama: ‚ÄûIhr werdet nicht glauben, was passiert ist!‚Äú",
      "Streitkommentare: Zwei Influencer attackieren sich.",
      "√úbertriebene Behauptung: ‚ÄûAlles wird schlimmer!‚Äú",
      "Faktenbericht √ºber ein aktuelles Ereignis.",
      "Objektiver Podcast √ºber Technologie.",
      "Skandalpost: ‚ÄûDie Wahrheit wird verschwiegen!‚Äú",
      "Politisch verzerrter Kurzclip.",
      "Drama-Video √ºber eine √ºberzogene Situation.",
      // ‚Ä¶ insgesamt 105
    ]
  },

  3: {
    story: "Finales Level: Der Algorithmus k√§mpft hart um dich!",
    posts: [
      /* --- 105 LEVEL-3 POSTS --- */
      "Niedliches Tier, das durch den Schnee springt.",
      "Fakten-Check: Ger√ºchte √ºber ein Trendthema.",
      "Neutraler Info-Clip √ºber Wissenschaft.",
      "Clickbait: ‚ÄûDu MUSST das gesehen haben!!‚Äú",
      "Emotionales Statement √ºber Ungerechtigkeit.",
      "Politisches Drama: alles ist eine Krise.",
      "Meinungspost mit starker √úbertreibung.",
      "Manipulativer Viralclip, der Angst erzeugt.",
      "Verdrehte Fakten, die Panik sch√ºren.",
      // ‚Ä¶ insgesamt 105
    ]
  }
};

/* ======================================================
   SETUP
====================================================== */
function deepCopy(obj) {
  return JSON.parse(JSON.stringify(obj));
}

function startLevel() {
  bubble = 80;
  bubbleValue.textContent = bubble;

  storyBox.textContent = levels[level].story;

  feed.style.display = "block";
  storyBox.style.display = "block";
  win.style.display = "none";
  gameOver.style.display = "none";

  // Reset Pool f√ºr dieses Level
  originalPools[level] = deepCopy(levels[level].posts);
  levels[level].posts = deepCopy(originalPools[level]);

  renderPosts();
}

/* ======================================================
   POSTS RENDERN
====================================================== */
function renderPosts() {
  feed.innerHTML = "";

  let pool = levels[level].posts;

  // Wenn weniger als 4 Posts √ºbrig sind ‚Üí alle anzeigen
  let amount = Math.min(4, pool.length);

  for (let i = 0; i < amount; i++) {
    let index = Math.floor(Math.random() * pool.length);
    let text = pool[index];

    let div = document.createElement("div");
    div.className = "post";
    div.textContent = text;
    div.dataset.effect = getEffect(text);
    div.onclick = () => handlePost(div, index);

    feed.appendChild(div);
  }
}

/* ======================================================
   POST EFFECTS ‚Äî automatisch
====================================================== */
function getEffect(text) {
  if (text.includes("Clickbait") || text.includes("Drama") || text.includes("Verdrehte") || text.includes("Manipulativ") || text.includes("Politisch"))
    return +10;

  if (text.includes("Werbung") || text.includes("Suggestiver"))
    return +5;

  if (text.includes("Fakten") || text.includes("Neutral") || text.includes("Sachlich") || text.includes("Objektiv"))
    return -10;

  if (text.includes("Wissenschaft") || text.includes("Analyse"))
    return -15;

  return -5;
}

/* ======================================================
   POST KLICKEN
====================================================== */
function handlePost(div, index) {
  let effect = Number(div.dataset.effect);

  // Filterblase ver√§ndern
  bubble = Math.min(100, Math.max(0, bubble + effect));
  bubbleValue.textContent = bubble;

  // Post aus Pool entfernen
  levels[level].posts.splice(index, 1);

  div.remove();

  if (bubble <= 0) {
    nextLevel();
    return;
  }

  if (bubble >= 100) {
    triggerGameOver();
    return;
  }

  renderPosts();
}

/* ======================================================
   LEVEL / GAMEOVER
====================================================== */
function nextLevel() {
  level++;

  if (level > 3) {
    feed.style.display = "none";
    storyBox.style.display = "none";
    win.style.display = "block";
    return;
  }

  startLevel();
}

function triggerGameOver() {
  feed.style.display = "none";
  storyBox.style.display = "none";
  gameOver.style.display = "block";
  restartBtn.style.display = "block";
}

/* ======================================================
   RESTART
====================================================== */
restartBtn.onclick = () => {
  level = 1;
  gameOver.style.display = "none";
  restartBtn.style.display = "none";
  levels[1].posts = deepCopy(originalPools[1]);
  levels[2].posts = deepCopy(originalPools[2]);
  levels[3].posts = deepCopy(originalPools[3]);
  startLevel();
};

/* ======================================================
   INIT
====================================================== */
originalPools = deepCopy({
  1: levels[1].posts,
  2: levels[2].posts,
  3: levels[3].posts
});

startLevel();
</script>

</body>
</html>
